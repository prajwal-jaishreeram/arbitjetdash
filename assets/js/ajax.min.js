function xhrCall(to,data,options,callback){var defaultOptions={cache:false,type:"get",dataType:"json"};if(typeof options==="object"){$.extend(defaultOptions,options)}if(typeof data!=="object"){console.log("xhrCall expects object for second parameter");return false}defaultOptions["url"]=to;defaultOptions["data"]=data;$.ajax(defaultOptions).done((function(res){if(typeof callback==="function"){if(defaultOptions["dataType"]==="json"){if(typeof res==="object"){callback(res)}else{console.log("Expecting an object from XHR")}}else{callback(res)}}})).fail((function(jqXHR,textStatus,errorThrown){console.log("XHR Failed: "+textStatus);console.log(errorThrown)}))}function xhrForm(form,callback){if($(form).is("form")){var to=$(form).attr("action");$(form).find(":submit").attr("disabled",true);xhrCall(to,$(form).serializeArray(),{type:"post"},callback);$(form).find(":submit").attr("disabled",false)}}function xhrFormData(form,callback){if($(form).is("form")){var to=$(form).attr("action");$(form).find(":submit").attr("disabled",true);xhrCall(to,new FormData($(form)[0]),{type:"post",processData:false,contentType:false},callback);$(form).find(":submit").attr("disabled",false)}}function processFormResult(form,result){if($(form).is("form")){if(typeof result==="object"){if(result.hasOwnProperty("param")){$(form).find('input[name="'+result["param"]+'"]').closest("div.form-group").addClass("has-error")}xhrResult(result)}}}function xhrResult(result){if(typeof result==="object"){if(result.hasOwnProperty("success")&&result.hasOwnProperty("message")){if(typeof result["message"]==="string"&&result["message"].length>0){var notyType="success";var notyLayout="bottom";if(result["success"]===false){notyType="information";notyLayout="bottomLeft"}issueNoty(notyType,result["message"],notyLayout)}}}}function resetForm(form){if($(form).is("form")){$(form).find("div.form-group").removeClass("has-error")}}window.issueNoty=function(type,msg,pos){if(pos==null)pos="bottomLeft";var notyOptions={layout:pos,text:msg,theme:"bootstrapTheme",type:type,timeout:8e3,animation:{open:"animated fadeIn",close:"animated fadeOut",easing:"swing",speed:500}};var n=noty(notyOptions)};function regularXhrForm(form,callback){if($(form).is("form")){resetForm(form);xhrForm(form,(function(result){processFormResult(form,result);if(typeof callback==="function"){callback(result)}}))}}$(document).on("submit","form.xhr-form",(function(e){e.preventDefault();e.stopPropagation();if($(this).is("form")){var form=this;regularXhrForm(form,(function(result){if(result.hasOwnProperty("redirect")){setTimeout((function(){document.location.replace(result["redirect"])}),1500)}else if(result.hasOwnProperty("refresh")){setTimeout((function(){document.location.reload()}),1500)}if(result.hasOwnProperty("reset")){if(typeof result["reset"]==="string"){$(form).find(':input[name="'+result["reset"]+'"]').val("")}else{$(form)[0].reset()}}if(result.hasOwnProperty("destruct")){$(form).attr("src","#");$(form).find(":submit").hide()}if($(form).hasClass("has-recaptcha")){grecaptcha.reset()}}))}}));